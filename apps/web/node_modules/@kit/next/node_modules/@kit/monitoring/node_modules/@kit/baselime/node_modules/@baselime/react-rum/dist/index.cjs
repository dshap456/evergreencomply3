"use client";var P=Object.create;var p=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var V=Object.getPrototypeOf,W=Object.prototype.hasOwnProperty;var D=(e,t)=>{for(var s in t)p(e,s,{get:t[s],enumerable:!0})},B=(e,t,s,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of T(t))!W.call(e,a)&&a!==s&&p(e,a,{get:()=>t[a],enumerable:!(o=L(t,a))||o.enumerable});return e};var U=(e,t,s)=>(s=e!=null?P(V(e)):{},B(t||!e||!e.__esModule?p(s,"default",{value:e,enumerable:!0}):s,e)),K=e=>B(p({},"__esModule",{value:!0}),e);var _={};D(_,{BaselimeErrorBoundary:()=>h,BaselimeRum:()=>O,useBaselimeRum:()=>c});module.exports=K(_);var A=require("react"),b=U(require("js-cookie"),1);var m=require("react");var N=["url","method","baseURL","headers","params","data","timeout","timeoutErrorMessage","withCredentials","auth","responseType","proxy","decompress"];function y(e){var o,a,u,d,f,n;let t=N.reduce((i,l)=>({...i,[l]:e.config[l]}),{}),s={data:(o=e.response)==null?void 0:o.data,status:(a=e.response)==null?void 0:a.status,statusText:(u=e.response)==null?void 0:u.statusText,headers:(d=e.response)==null?void 0:d.headers};return{config:t,response:s,code:e.code,stack:e.stack,name:e.name,message:e.message||`Request failed${(f=e.response)!=null&&f.status?` with status code ${(n=e.response)==null?void 0:n.status}`:""}`,isAxiosError:!0}}function C(e){return e!=null&&e.isAxiosError?y(e):{name:e.name,message:e.message,stack:e.stack}}var x=(0,m.createContext)({});function c(){let{config:e,setConfig:t,queue:s}=(0,m.useContext)(x),o=!e||!s,a=(0,m.useCallback)(n=>{if(!o)return t(i=>({...i,userId:n}))},[o]),u=(0,m.useCallback)((n,i={})=>{if(o)return;let l={level:(i==null?void 0:i.level)||"info",message:n,...i};s.push(l,e)},[o,e]),d=(0,m.useCallback)((n,i)=>{if(o)return;if(i){let q=i.componentStack.split("@")[0],F={level:"error",data:{error:n},stack:i.componentStack,error:{message:n.message,name:n.name,cause:n.cause},causedBy:q,message:`${n.name}: ${n.message}`};return s.push(F,e)}let l=C(n),S={level:"error",data:{error:n},stack:i==null?void 0:i.componentStack,error:{...l},message:`${n.name}: ${n.message}`};s.push(S,e)},[o,e]),f=(0,m.useCallback)(n=>{if(o)return;let i={...n,data:n.entries[0],entries:void 0};s.push(i,e)},[o,e]);return o&&console.warn("Using useBaselimeRum outside of BaselimeRum context, operations will be no-ops"),{config:e,setUser:a,captureException:d,sendEvent:u,_trackWebVital:f}}var I=require("react"),r=require("web-vitals");function v(e){let{config:t,_trackWebVital:s,sendEvent:o}=c();return(0,I.useEffect)(()=>{if(!t.enableLocal&&typeof window<"u"&&window.location.hostname==="localhost")return;t.enableWebVitals&&((0,r.onCLS)(s),(0,r.onFCP)(s),(0,r.onINP)(s),(0,r.onLCP)(s),(0,r.onTTFB)(s),(0,r.onFID)(s));function a(u){u({data:{timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,lanuage:navigator.language,os:navigator.oscpu||navigator.platform,userAgent:navigator.userAgent,url:window.location.href},hostname:window.location.hostname,path:window.location.pathname})}a(u=>o("Page View",u))},[]),e.children}var g=class{queue;queueSize;duration;timeout=null;constructor(){this.queue=[]}push(t,s){if(this.queue.push(t),this.queue.length>=this.queueSize)return this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.flush(s);this.timeout||(this.timeout=setTimeout(()=>{this.flush(s),this.timeout=null},this.duration))}async flush(t){if(this.queue.length===0)return;let s=this.queue;this.queue=[],await fetch(`${t.url||"https://events.baselime.io/v1"}/${t.dataset||"web"}`,{method:"POST",headers:{contentType:"application/json","x-api-key":t.apiKey,"user-agent":"@baselime/react-rum/0.1.5",library:"@baselime/react-rum/0.1.5","x-service":t.service||window.location.hostname,"x-namespace":t.namespace||window.location.pathname},body:JSON.stringify(s.map(o=>({userId:t.userId,sessionId:t.sessionId,pageLoadId:t.pageLoadId,namespace:t.namespace||window.location.pathname,...o})))})}};var k=require("react-error-boundary");var w=require("react/jsx-runtime");function h(e){let{captureException:t}=c();function s(o,a){var u;try{t(o,a)}catch{}(u=e.onError)==null||u.call(e,o,a)}return(0,w.jsx)(k.ErrorBoundary,{...e,onError:s,children:e.children})}function R(){try{return crypto.randomUUID()}catch{return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}}var E=require("react/jsx-runtime"),$=new g;function O(e){b.default.get("baselime-session-id")||b.default.set("baselime-session-id",R());let s={userId:e.userId,sessionId:b.default.get("baselime-session-id"),pageLoadId:R(),namespace:e.namespace,apiKey:e.apiKey,dataset:e.dataset||"web",service:e.service,url:e.url||"https://events.baselime.io/v1",enableLocal:e.enableLocal||!1,enableWebVitals:e.enableWebVitals||!1},[o,a]=(0,A.useState)(s);return(0,E.jsx)(x.Provider,{value:{config:o,setConfig:a,queue:$},children:(0,E.jsx)(h,{fallback:e.fallback,fallbackRender:e.fallbackRender,children:(0,E.jsx)(v,{children:e.children})})})}0&&(module.exports={BaselimeErrorBoundary,BaselimeRum,useBaselimeRum});
