"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const m=require("ts-case-convert");function q(o,v="*"){if(!o)return v;let s;if(Array.isArray(o)){const u=o,f=new Map,b=[];for(let l=0;l<u.length;l++){const i=u[l];if(i.split(".").length>1){const[d,p]=i.split(".");f.set(d,[...f.get(d)??[],p])}else b.push(i)}for(const[l,i]of Array.from(f.entries()))b.push(`${l} !inner (${i.join(",")})`);s=b.join(",")}else s=o;return s}async function C(o){const{client:v,table:s,where:u,sort:f,select:b="*",page:l=1,limit:i=10,count:d="exact"}=o,p=o.camelCase??!1,A=q(b);let t=v.from(s).select(A,{count:d??"exact"});if(u)if(typeof u!="function"){const c=Object.keys(u);for(const y of c){const n=u[y];if(!n)continue;const S=Object.keys(n??{});for(const r of S){const a=y;switch(r){case"eq":{const e=n[r];if(e==null)continue;t=t.eq(a,e);break}case"neq":{const e=n[r];if(e==null)continue;t=t.neq(a,e);break}case"in":{const e=n[r];if(e===void 0)continue;t=t.in(a,e);break}case"like":{const e=n[r];if(e===void 0)continue;t=t.like(a,e);break}case"ilike":{const e=n[r];if(e===void 0)continue;t=t.ilike(a,e);break}case"gt":{const e=n[r];if(e===void 0)continue;t=t.gt(a,e);break}case"lt":{const e=n[r];if(e===void 0)continue;t=t.lt(a,e);break}case"gte":{const e=n[r];if(e===void 0)continue;t=t.gte(a,e);break}case"lte":{const e=n[r];if(e===void 0)continue;t=t.lte(a,e);break}case"textSearch":{const e=n[r];if(e===void 0)continue;t=t.textSearch(a,e);break}case"containedBy":{const e=n[r];if(!Array.isArray(e))continue;t=t.containedBy(a,e);break}case"contains":{const e=n[r];if(!Array.isArray(e))continue;t=t.contains(a,e);break}case"not":{const e=n[r];if(e===void 0)continue;for(const g in e)if(g in e){const j=e[g];t=t.not(a,g,j)}break}case"is":{const e=n[r];if(e===void 0)continue;t=t.is(a,e);break}}}}}else typeof u=="function"&&(t=u(t));if(!o.single){if(f)for(const c in f)t=t.order(c,{ascending:f[c]==="asc"});if(l&&i){const c=(l-1)*i,y=c+i;t=t.range(c,y)}i&&(t=t.limit(i))}if(o.single){const c=await t.maybeSingle();return{data:h(c.data??void 0,p),count:c.count??0,error:c.error}}const k=await t;return{data:h(k.data??[],p),count:k.count??0,error:k.error}}function h(o,v){return v?Array.isArray(o)?o.map(s=>s&&m.objectToCamel(s)):o?m.objectToCamel(o):void 0:o}exports.fetchDataFromSupabase=C;
